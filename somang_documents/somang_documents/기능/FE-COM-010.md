## 기능 명세서: 보안 채팅

### 1. 기능 기본 정보

| 항목 | 내용 |
| :--- | :--- |
| **기능 ID** | `FE-COM-010` |
| **기능명** | 보안 채팅 (Secure Chat) |
| **설명** | 사용자와 판매점이 1:1로 안전하게 소통하는 실시간 채팅 기능입니다. 모든 채팅 데이터는 독립된 **Chatting 프로젝트**에서 중앙 관리됩니다. |
| **관련 서비스** | -   **user-app**: 최종 사용자의 채팅 UI 제공<br>-   **biz-app**: 판매점주의 채팅 UI 제공<br>-   **chatting-app (Supabase Project)**: 채팅 데이터 저장 및 실시간 메시지 중계 |

### 2. 요구사항

#### 2.1. 사용자 스토리
> 판매점의 말바꿈이 걱정되는 **사용자로서**, 견적을 수락한 판매점과 앱 내에서만 소통하여, 약속된 모든 조건을 명확한 기록으로 남겨 안전하게 거래하고 싶다.

#### 2.2. 세부 요구사항 (기능 명세)

-   견적 수락 등 특정 조건이 충족되면, `user-app`과 `biz-app`은 API를 통해 `chatting-app`에 채팅방 생성을 요청한다.
-   `chatting-app`은 고유한 `room_id`를 생성하고, `user-app`과 `biz-app`은 이 ID를 각자의 DB에 저장한다.
-   `user-app`과 `biz-app`의 클라이언트는 **`chatting-app`의 Supabase 클라이언트**를 사용하여 채팅방에 연결하고 메시지를 송수신한다.
-   모든 메시지는 `chatting-app`의 DB에 영구적으로 기록된다.

### 3. 데이터 흐름

1.  **채팅방 생성**: `biz-app`에서 견적을 수락하면, `biz-app`의 백엔드가 `chatting-app`에 채팅방 생성을 요청하고 `room_id`를 받아 자신의 DB에 저장합니다.
2.  **채팅방 입장 및 구독**: `user-app`과 `biz-app` 클라이언트는 `room_id`를 기반으로 **`chatting-app`의 Realtime 서비스**에 연결하고 채널을 구독합니다.
3.  **메시지 전송**: 사용자가 메시지를 보내면, 해당 앱의 클라이언트는 **`chatting-app`의 API**를 호출하여 메시지를 저장합니다.
4.  **실시간 브로드캐스트**: `chatting-app`의 DB에 메시지가 저장되면, Realtime 서비스가 구독 중인 모든 클라이언트(user, biz)에게 새 메시지를 푸시합니다.
5.  **실시간 수신**: 각 클라이언트는 새 메시지를 받아 화면에 렌더링합니다.
